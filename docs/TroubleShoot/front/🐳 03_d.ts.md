# ğŸ³ 03_d.ts

## ğŸ¤” ë¬¸ì œ ìƒí™©

typeê´€ë¦¬ë¥¼ ìœ„í•œ d.tsì— ëŒ€í•´ ê³µì‹ë¬¸ì„œì™€ ë¸”ë¡œê·¸ê¸€ë“¤ì„ ì •ë¦¬í•˜ë©° ì•Œì•„ë³´ê¸°



## ğŸš© í•´ê²° ë°©ì•ˆ

ì •ë¦¬ëœ ë‚´ìš©ì´ ì˜ëª»ëœ ë¶€ë¶„ì´ ìˆì„ ìˆ˜ ìˆìœ¼ë‹ˆ ê³„ì†í•´ì„œ í™•ì¸í•´ë³´ì.



## ğŸ” ê´€ë ¨ Study

ì¼ë°˜ì ì¸ CommonJS íŒ¨í„´

`module.exports`ë¥¼ ì‚¬ìš©í•´ ë‚´ë³´ë‚¸ ê°’ì„ ì„¤ëª…í•œë‹¤.

```javascript
const maxInterval = 12;
function getArrayLength(arr) {
  return arr.length;
}
module.exports = {
  getArrayLength,
  maxInterval,
};
```

`.d.ts`ì—ì„œ ì•„ë˜ì²˜ëŸ¼ ë  ìˆ˜ ìˆë‹¤.

```typescript
export function getArrayLength(arr: any[]): number;
export const maxInterval: 12;
```



CommonJSì—ì„œëŠ” ëª¨ë“  ê°’ì„ default exportë¡œ ë‚´ë³´ë‚¼ ìˆ˜ ìˆë‹¤.

```javascript
// js
module.exports = /hello( world)?/;
```

```typescript
// d.ts
declare const helloWorld: RegExp;
export default helloWorld;
```



CommonJSì—ì„œ ë‚´ë³´ë‚´ê¸°ì˜ í•œê°€ì§€ ìŠ¤íƒ€ì¼ì€ í•¨ìˆ˜ë¥¼ ë‚´ë³´ë‚´ëŠ” ê²ƒ.

í•¨ìˆ˜ë„ objectì´ê¸° ë•Œë¬¸ì—, ì¶”ê°€ í•„ë“œë¥¼ ì¶”ê°€í•˜ê³  exportì— í¬í•¨í•  ìˆ˜ ìˆë‹¤.

```javascript
function getArrayLength(arr) {
  return arr.length;
}
getArrayLength.maxInterval = 12;
module.exports = getArrayLength;
```

```typescript
export default function getArrayLength(arr: any[]): number;
export const maxInterval: 12;
```



`d.ts`íŒŒì¼ì—ì„œ export defaultë¥¼ ì‚¬ìš©í•˜ë ¤ë©´, `esModuleInterop: true`ê°€ í•„ìš”í•˜ë‹¤.

`esModuelInterop: true`ë¥¼ í”„ë¡œì íŠ¸ì— í¬í•¨í•  ìˆ˜ ì—†ë‹¤ë©´, ëŒ€ì‹  `export =`ë¥¼ ì‚¬ìš©.

ì‚¬ìš©í•˜ê¸°ëŠ” ì–´ë µì§€ë§Œ, ëª¨ë“  ê³³ì—ì„œ ì‘ë™í•©ë‹ˆë‹¤.

```typescript
declare function getArrayLength(arr: any[]): number;
declare namespace getArrayLength {
  declare const maxInterval: 12;
}
export = getArrayLength;
```



## Handling Many Consuming Import

module import í•˜ëŠ” ë°©ë²•ì—ëŠ” ì—¬ëŸ¬ê°€ì§€ ë°©ë²•ì´ ìˆë‹¤.

```javascript
const fastify = require("fastify");
const { fastify } = require("fastify");
import fastify = require("fastify");
import * as Fastify from "fastify";
import { fastify, FastifyInstance } from "fastify";
import fastify from "fastify";
import fastify, { FastifyInstance } from "fastify";
```

ì´ëŸ° ê²½ìš°ë¥¼ ëª¨ë‘ ë‹¤ë£¨ë ¤ë©´, ëª¨ë“  íŒ¨í„´ì„ ì‹¤ì œë¡œ ì§€ì›í•˜ëŠ” JSì½”ë“œê°€ í•„ìš”í•˜ë‹¤.

```javascript
class FastifyInstance {}
function fastify() {
  return new FastifyInstance();
}
fastify.FastifyInstance = FastifyInstance;
// Allows for { fastify }
fastify.fastify = fastify;
// Allows for strict ES Module support
fastify.default = fastify;
// Sets the default export
module.exports = fastify;
```



## Types in Modules

ì¡´ì¬í•˜ì§€ ì•ŠëŠ” JavaScript ì½”ë“œì— ëŒ€í•œ ìœ í˜•ì„ ì œê³µí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```javascript
function getArrayMetadata(arr) {
  return {
    length: getArrayLength(arr),
    firstObject: arr[0],
  };
}
module.exports = {
  getArrayMetadata,
};
```

```typescript
export type ArrayMetadata = {
  length: number;
  firstObject: any | undefined;
};
export function getArrayMetadata(arr: any[]): ArrayMetadata;
```

ì´ ì˜ˆì œëŠ” genericì„ ì‚¬ìš©í•˜ì—¬ ë” í’ë¶€í•œ type ì •ë³´ë¥¼ ì œê³µí•˜ëŠ” ì¢‹ì€ ì‚¬ë¡€ì´ë‹¤.

```typescript
export type ArrayMetadata<ArrType> = {
  length: number;
  firstObject: ArrType | undefined;
};
export function getArrayMetadata<ArrType>(
  arr: ArrType[]
): ArrayMetadata<ArrType>;
```



## Namespaces in Module Code

JSì½”ë“œì˜ runtimeê´€ê³„ë¥¼ ì„¤ëª…í•˜ëŠ” ê²ƒì€ ê¹Œë‹¤ë¡œìš¸ ìˆ˜ ìˆë‹¤.

ES Moduleê³¼ ê°™ì€ êµ¬ë¬¸ì´ exportë¥¼ ì„¤ëª…í•˜ê¸°ì— ì¶©ë¶„í•œ ë„êµ¬ë¥¼ ì œê³µí•˜ì§€ ì•ŠëŠ” ê²½ìš°, namespaceë¥¼ ì´ìš©.

```typescript
// This represents the JavaScript class which would be available at runtime
export class API {
  constructor(baseURL: string);
  getInfo(opts: API.InfoRequest): API.InfoResponse;
}
// This namespace is merged with the API class and allows for consumers, and this file
// to have types which are nested away in their own sections.
declare namespace API {
  export interface InfoRequest {
    id: string;
  }
  export interface InfoResponse {
    width: number;
    height: number;
  }
}
```

https://www.typescriptlang.org/docs/handbook/declaration-files/deep-dive.html



## Example

```typescript
// Type definitions for [~THE LIBRARY NAME~] [~OPTIONAL VERSION NUMBER~]
// Project: [~THE PROJECT NAME~]
// Definitions by: [~YOUR NAME~] <[~A URL FOR YOU~]>
/*~ This is the module template file. You should rename it to index.d.ts
 *~ and place it in a folder with the same name as the module.
 *~ For example, if you were writing a file for "super-greeter", this
 *~ file should be 'super-greeter/index.d.ts'
 */
/*~ If this module is a UMD module that exposes a global variable 'myLib' when
 *~ loaded outside a module loader environment, declare that global here.
 *~ Otherwise, delete this declaration.
 */
export as namespace myLib;
/*~ If this module exports functions, declare them like so.
 */
export function myFunction(a: string): string;
export function myOtherFunction(a: number): number;
/*~ You can declare types that are available via importing the module */
export interface SomeType {
  name: string;
  length: number;
  extras?: string[];
}
/*~ You can declare properties of the module using const, let, or var */
export const myField: number;
```





## í´ë” êµ¬ì¡°

ì‹¤ì œ íŒŒì¼ê³¼ ë™ì¼í•˜ê²Œ.

```text
myLib
  +---- index.js
  +---- foo.js
  +---- bar
         +---- index.js
         +---- baz.js
```

```text
// type
@types/myLib
  +---- index.d.ts
  +---- foo.d.ts
  +---- bar
         +---- index.d.ts
         +---- baz.d.ts
```



## ğŸ“˜ ì°¸ê³ 

https://www.typescriptlang.org/docs/handbook/declaration-files/templates/module-d-ts.html

https://www.typescriptlang.org/docs/handbook/declaration-files/deep-dive.html

[https://velog.io/@milkcoke/Typescript-d.ts-.ì •ì˜í•˜ê¸°](https://velog.io/@milkcoke/Typescript-.d.ts-ì •ì˜í•˜ê¸°)

https://jake-seo-dev.tistory.com/207

https://bum-developer.tistory.com/entry/TypeScript-dts

https://ssocoit.tistory.com/253